{"version":3,"sources":["../../src/pages/atendimento-usuario/atendimento-usuario.module.ts","../../src/pages/atendimento-usuario/atendimento-usuario.ts"],"names":[],"mappings":"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","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AtendimentoUsuarioPage } from './atendimento-usuario';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AtendimentoUsuarioPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AtendimentoUsuarioPage),\r\n  ],\r\n})\r\nexport class AtendimentoUsuarioPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/atendimento-usuario/atendimento-usuario.module.ts","import { UtilsProvider } from './../../providers/utils/utils';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController } from 'ionic-angular';\r\nimport { Usuario } from '../../model/usuario';\r\nimport { StorageProvider } from '../../providers/storage/storage';\r\nimport { ConexaoApiProvider } from '../../providers/conexao-api/conexao-api';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { StatusBar } from '@ionic-native/status-bar';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-atendimento-usuario',\r\n  templateUrl: 'atendimento-usuario.html',\r\n})\r\nexport class AtendimentoUsuarioPage {\r\n\r\n  usuario: Usuario;\r\n  listTutorDisponivel: Array<any>;\r\n  //private img_user_64: any = \"data:image/png+xml;base64,\";\r\n  image_user_toolbar: any;\r\n\r\n  constructor(private conexaoApi: ConexaoApiProvider, private domSanitizer: DomSanitizer, private navCtrl: NavController,\r\n    private storage: StorageProvider, private statusBar: StatusBar, private utilsPr: UtilsProvider) {\r\n\r\n    this.usuario = new Usuario()\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n\r\n    // let status bar overlay webview\r\n    this.statusBar.overlaysWebView(false);\r\n\r\n    // set status bar to white\r\n    this.statusBar.backgroundColorByHexString('#311734');\r\n\r\n    this.storage.getInfo(\"usuario\")\r\n      .then((usuario) => {\r\n        this.usuario = usuario;\r\n\r\n        let img_user_64: any = \"data:image/png+xml;base64,\"\r\n        img_user_64 += this.usuario.image;\r\n        this.image_user_toolbar = this.domSanitizer.bypassSecurityTrustUrl(img_user_64);\r\n\r\n        this.conexaoApi.tutorsJob(this.usuario.token.access_token)\r\n          .then((tutores: any) => {\r\n            this.listTutorDisponivel = tutores.json();\r\n            this.convertImageTo64(this.listTutorDisponivel);\r\n          })\r\n          .catch((error) => this.utilsPr.alertInformation('Não há tutores disponíveis!'));\r\n      });\r\n  }\r\n\r\n  solicitarAtendimento() {\r\n    this.utilsPr.getLocation()\r\n      .then((coordenadas: any) => {\r\n        this.conexaoApi.requisition(this.usuario.token.access_token, this.usuario.id, coordenadas.lat, coordenadas.long)\r\n          .then((requisition: any) => {\r\n            //Retorna as matérias que o aluno pode solicitar atendimento. Envia a lista para página de seleção\r\n            //Após seleção da matéria, acessa a pagina para aluno escolher a matéria e solicitar o atendimento\r\n            this.navCtrl.push('AtendimentoUsuarioMateriaPage', { requisition: requisition });\r\n          })\r\n          .catch((error) => {\r\n            if(error.status ==401){\r\n              this.utilsPr.alertInformation(error.json().message);\r\n            }\r\n            else{\r\n              this.utilsPr.alertError(\"Ocorreu um erro ao solicitar o atendimento. Tente novamente!\");\r\n            }\r\n          });       \r\n      })\r\n      .catch(()=>{\r\n        this.utilsPr.alertError(\"Não foi possível acessar a localização do aparelho!\");\r\n      })\r\n  }\r\n\r\n  chamadosPendentes() {\r\n    this.conexaoApi.myCallsDatePending(this.usuario.token.access_token)\r\n      .then((callsPending: any) => {\r\n        if (callsPending.length > 0) {\r\n          //Lista os chamados pendentes e chama a tela para listar os chamados. Na tela é possível cancelar cada chamado\r\n          this.navCtrl.push('AtendimentoUsuarioPendentePage',\r\n            { callsPending: callsPending, access_token: this.usuario.token.access_token });\r\n        }\r\n        else {\r\n          this.utilsPr.alertInformation(\"Não há chamados pendentes!\");\r\n        }\r\n\r\n      })\r\n      .catch(() => {\r\n        this.utilsPr.alertError(\"Não foi possível listar os chamados pendentes. Tente novamente!\");\r\n      })\r\n  }\r\n\r\n  convertImageTo64(listTutor: Array<any>) {\r\n\r\n    for (let i = 0; i < listTutor.length; i++) {\r\n      let img_user_64: any = \"\";\r\n      img_user_64 = \"data:image/png+xml;base64,\"\r\n      img_user_64 += this.listTutorDisponivel[i].image;\r\n\r\n      let image = this.listTutorDisponivel[i].image;\r\n      image == null || image == \"\" ? image = \"assets/imgs/no-photo.jpg\"\r\n        : image = this.domSanitizer.bypassSecurityTrustUrl(img_user_64);\r\n      //console.log(\"Image: \", image);\r\n      this.listTutorDisponivel[i].image = image;\r\n\r\n      //this.image_user_toolbar = this.listTutorDisponivel[0].image;\r\n    }\r\n\r\n  }\r\n\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/atendimento-usuario/atendimento-usuario.ts"],"sourceRoot":""}